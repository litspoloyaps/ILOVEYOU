<html>
<head>
<title>LOVE LETTER</title>

<hta:application
    id="LoveLetter"
    border="none"
    caption="no"
    showintaskbar="no"
    windowstate="maximize"
/>

<style>
body {
    margin: 0;
    background-color: black;
    color: white;
    font-family: Georgia, serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    text-align: center;
}

#text {
    font-size: 32px;
    width: 70%;
    opacity: 1;
    transition: opacity 3s ease;
}

.fadeOut {
    opacity: 0;
}
</style>

<script>
var poem = 
"LOVE-LETTER-FOR-YOU\n\n" +
"If I could fold my heart into an envelope,\n" +
"I would seal it with the quiet hope\n" +
"that when you open it,\n" +
"you feel how softly you are held in my thoughts.\n\n" +
"You are the gentle pause between my worries,\n" +
"the warmth in ordinary afternoons,\n" +
"the reason even silence feels full\n" +
"instead of empty.\n\n" +
"You are the place my heart returns to,\n" +
"again and again.\n\n" +
"Forever yours.";

var i = 0;
var speed = 40;

function typeWriter() {
    if (i < poem.length) {
        document.getElementById("text").innerHTML += 
            poem.charAt(i) == "\n" ? "<br>" : poem.charAt(i);
        i++;
        setTimeout(typeWriter, speed);
    } else {
        setTimeout(finalFade, 3000);
    }
}

function finalFade() {
    var textDiv = document.getElementById("text");
    textDiv.classList.add("fadeOut");

    setTimeout(function() {
        textDiv.innerHTML = "I love you.";
        textDiv.classList.remove("fadeOut");
        textDiv.style.opacity = "1";
    }, 3000);

    setTimeout(function() {
        window.close();
    }, 8000);
}

window.onload = function() {
    document.getElementById("bgmusic").play();
    typeWriter();
};
</script>

</head>

<body>

<div id="text"></div>

<audio id="bgmusic" loop>
    <source src="music.mp3" type="audio/mpeg">
</audio>

</body>
</html>
